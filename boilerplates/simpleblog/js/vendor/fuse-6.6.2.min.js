!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Fuse=t()}(this,function(){"use strict";function r(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach(function(e){c(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function e(e,t,n){t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1})}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&n(e,t)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");t=e;if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=a(n);return N(this,r?(e=a(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function p(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var n;if(e)return"string"==typeof e?h(e,t):"Map"===(n="Object"===(n=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e){return Array.isArray?Array.isArray(e):"[object Array]"===k(e)}var P=1/0;function W(e){return null==e?"":"string"==typeof(e=e)?e:"0"==(t=e+"")&&1/e==-P?"-0":t;var t}function f(e){return"string"==typeof e}function d(e){return"number"==typeof e}function T(e){return!0===e||!1===e||g(t=e)&&null!==t&&"[object Boolean]"==k(e);var t}function g(e){return"object"===t(e)}function y(e){return null!=e}function m(e){return!e.trim().length}function k(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var D=function(e){return"Missing ".concat(e," property in key")},z=function(e){return"Property 'weight' in key '".concat(e,"' must be a positive integer")},M=Object.prototype.hasOwnProperty,K=function(){function r(e){var t=this,n=(v(this,r),this._keys=[],this._keyMap={},0);e.forEach(function(e){e=b(e);n+=e.weight,t._keys.push(e),t._keyMap[e.id]=e,n+=e.weight}),this._keys.forEach(function(e){e.weight/=n})}return e(r,[{key:"get",value:function(e){return this._keyMap[e]}},{key:"keys",value:function(){return this._keys}},{key:"toJSON",value:function(){return JSON.stringify(this._keys)}}]),r}();function b(e){var t=null,n=null,r=null,i=1,o=null;if(f(e)||l(e))t=x(r=e),n=w(e);else{if(!M.call(e,"name"))throw new Error(D("name"));var c=e.name,r=c;if(M.call(e,"weight")&&(i=e.weight)<=0)throw new Error(z(c));t=x(c),n=w(c),o=e.getFn}return{path:t,id:n,weight:i,src:r,getFn:o}}function x(e){return l(e)?e:e.split(".")}function w(e){return l(e)?e.join("."):e}var L={useExtendedSearch:!1,getFn:function(e,t){var s=[],a=!1;return function e(t,n,r){if(y(t))if(n[r]){var i=t[n[r]];if(y(i))if(r===n.length-1&&(f(i)||d(i)||T(i)))s.push(W(i));else if(l(i)){a=!0;for(var o=0,c=i.length;o<c;o+=1)e(i[o],n,r+1)}else n.length&&e(i,n,r+1)}else s.push(t)}(e,f(t)?t.split("."):t,0),a?s:s[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1},$=i(i(i(i({},{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function(e,t){return e.score===t.score?e.idx<t.idx?-1:1:e.score<t.score?-1:1}}),{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1}),{location:0,threshold:.6,distance:100}),L),q=/[^ ]+/g;var S=function(){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.getFn,t=void 0===t?$.getFn:t,e=e.fieldNormWeight,e=void 0===e?$.fieldNormWeight:e;v(this,n),this.norm=function(e,t){var n=0<arguments.length&&void 0!==e?e:1,e=1<arguments.length&&void 0!==t?t:3,r=new Map,i=Math.pow(10,e);return{get:function(e){var t,e=e.match(q).length;return r.has(e)?r.get(e):(t=1/Math.pow(e,.5*n),t=parseFloat(Math.round(t*i)/i),r.set(e,t),t)},clear:function(){r.clear()}}}(e,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}return e(n,[{key:"setSources",value:function(){this.docs=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]}},{key:"setIndexRecords",value:function(){this.records=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]}},{key:"setKeys",value:function(){var n=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.keys=e,this._keysMap={},e.forEach(function(e,t){n._keysMap[e.id]=t})}},{key:"create",value:function(){var n=this;!this.isCreated&&this.docs.length&&(this.isCreated=!0,f(this.docs[0])?this.docs.forEach(function(e,t){n._addString(e,t)}):this.docs.forEach(function(e,t){n._addObject(e,t)}),this.norm.clear())}},{key:"add",value:function(e){var t=this.size();f(e)?this._addString(e,t):this._addObject(e,t)}},{key:"removeAt",value:function(e){this.records.splice(e,1);for(var t=e,n=this.size();t<n;t+=1)--this.records[t].i}},{key:"getValueForItemAtKeyId",value:function(e,t){return e[this._keysMap[t]]}},{key:"size",value:function(){return this.records.length}},{key:"_addString",value:function(e,t){y(e)&&!m(e)&&(t={v:e,i:t,n:this.norm.get(e)},this.records.push(t))}},{key:"_addObject",value:function(c,e){var s=this,a={i:e,$:{}};this.keys.forEach(function(e,t){var e=e.getFn?e.getFn(c):s.getFn(c,e.path);if(y(e))if(l(e)){for(var n=[],r=[{nestedArrIndex:-1,value:e}];r.length;){var i=r.pop(),o=i.nestedArrIndex,i=i.value;y(i)&&(f(i)&&!m(i)?(o={v:i,i:o,n:s.norm.get(i)},n.push(o)):l(i)&&i.forEach(function(e,t){r.push({nestedArrIndex:t,value:e})}))}a.$[t]=n}else f(e)&&!m(e)&&(e={v:e,n:s.norm.get(e)},a.$[t]=e)}),this.records.push(a)}},{key:"toJSON",value:function(){return{keys:this.keys,records:this.records}}}]),n}();function B(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=n.getFn,r=void 0===r?$.getFn:r,n=n.fieldNormWeight,n=void 0===n?$.fieldNormWeight:n,r=new S({getFn:r,fieldNormWeight:n});return r.setKeys(e.map(b)),r.setSources(t),r.create(),r}function F(e,t){var t=1<arguments.length&&void 0!==t?t:{},n=t.errors,r=t.currentLocation,i=t.expectedLocation,o=t.distance,o=void 0===o?$.distance:o,t=t.ignoreLocation,t=void 0===t?$.ignoreLocation:t,n=(void 0===n?0:n)/e.length;return t?n:(e=Math.abs((void 0===i?0:i)-(void 0===r?0:r)),o?n+e/o:e?1:n)}function H(e,t,n,r){var r=3<arguments.length&&void 0!==r?r:{},i=r.location,i=void 0===i?$.location:i,o=r.distance,c=void 0===o?$.distance:o,o=r.threshold,o=void 0===o?$.threshold:o,s=r.findAllMatches,a=void 0===s?$.findAllMatches:s,s=r.minMatchCharLength,s=void 0===s?$.minMatchCharLength:s,u=r.includeMatches,u=void 0===u?$.includeMatches:u,r=r.ignoreLocation,h=void 0===r?$.ignoreLocation:r;if(32<t.length)throw new Error("Pattern length exceeds max of ".concat(32,"."));for(var l,f=t.length,d=e.length,v=Math.max(0,Math.min(i,d)),g=o,y=v,p=1<s||u,m=p?Array(d):[];-1<(l=e.indexOf(t,y));){var k=F(t,{currentLocation:l,expectedLocation:v,distance:c,ignoreLocation:h}),g=Math.min(k,g),y=l+f;if(p)for(var M=0;M<f;)M+=m[l+M]=1}y=-1;for(var b=[],x=1,w=f+d,L=1<<f-1,S=0;S<f;S+=1){for(var _=0,O=w;_<O;)F(t,{errors:S,currentLocation:v+O,expectedLocation:v,distance:c,ignoreLocation:h})<=g?_=O:w=O,O=Math.floor((w-_)/2+_);var w=O,A=Math.max(1,v-O+1),j=a?d:Math.min(v+O,d)+f,I=Array(j+2);I[j+1]=(1<<S)-1;for(var C=j;A<=C;--C){var E=C-1,R=n[e.charAt(E)];if(p&&(m[E]=+!!R),I[C]=(I[C+1]<<1|1)&R,S&&(I[C]|=(b[C+1]|b[C])<<1|1|b[C+1]),I[C]&L&&(x=F(t,{errors:S,currentLocation:E,expectedLocation:v,distance:c,ignoreLocation:h}))<=g){if(g=x,(y=E)<=v)break;A=Math.max(1,2*v-y)}}if(g<F(t,{errors:S+1,currentLocation:v,expectedLocation:v,distance:c,ignoreLocation:h}))break;b=I}r={isMatch:0<=y,score:Math.max(.001,x)};return p&&((i=function(e,t){for(var n=0<arguments.length&&void 0!==e?e:[],r=1<arguments.length&&void 0!==t?t:$.minMatchCharLength,i=[],o=-1,c=0,s=n.length;c<s;c+=1){var a=n[c];a&&-1===o?o=c:a||-1===o||(r<=(a=c-1)-o+1&&i.push([o,a]),o=-1)}return n[c-1]&&r<=c-o&&i.push([o,c-1]),i}(m,s)).length?u&&(r.indices=i):r.isMatch=!1),r}var J=function(){function d(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.location,r=void 0===r?$.location:r,i=t.threshold,i=void 0===i?$.threshold:i,o=t.distance,o=void 0===o?$.distance:o,c=t.includeMatches,c=void 0===c?$.includeMatches:c,s=t.findAllMatches,s=void 0===s?$.findAllMatches:s,a=t.minMatchCharLength,a=void 0===a?$.minMatchCharLength:a,u=t.isCaseSensitive,u=void 0===u?$.isCaseSensitive:u,t=t.ignoreLocation,t=void 0===t?$.ignoreLocation:t;if(v(this,d),this.options={location:r,threshold:i,distance:o,includeMatches:c,findAllMatches:s,minMatchCharLength:a,isCaseSensitive:u,ignoreLocation:t},this.pattern=u?e:e.toLowerCase(),this.chunks=[],this.pattern.length){var h=function(e,t){n.chunks.push({pattern:e,alphabet:function(e){for(var t={},n=0,r=e.length;n<r;n+=1){var i=e.charAt(n);t[i]=(t[i]||0)|1<<r-n-1}return t}(e),startIndex:t})},r=this.pattern.length;if(32<r){for(var l=0,i=r%32,f=r-i;l<f;)h(this.pattern.substr(l,32),l),l+=32;i&&h(this.pattern.substr(o=r-32),o)}else h(this.pattern,0)}}return e(d,[{key:"searchIn",value:function(r){var i,o,c,s,a,u,h,l,f,e=this.options,t=e.isCaseSensitive,d=e.includeMatches;return t||(r=r.toLowerCase()),this.pattern===r?(e={isMatch:!0,score:0},d&&(e.indices=[[0,r.length-1]])):(t=this.options,i=t.location,o=t.distance,c=t.threshold,s=t.findAllMatches,a=t.minMatchCharLength,u=t.ignoreLocation,l=0,f=!(h=[]),this.chunks.forEach(function(e){var t=e.pattern,n=e.alphabet,e=e.startIndex,t=H(r,t,n,{location:i+e,distance:o,threshold:c,findAllMatches:s,minMatchCharLength:a,includeMatches:d,ignoreLocation:u}),n=t.isMatch,e=t.score,t=t.indices;n&&(f=!0),l+=e,n&&t&&(h=[].concat(p(h),p(t)))}),e={isMatch:f,score:f?l/this.chunks.length:1},f&&d&&(e.indices=h)),e}}]),d}(),_=function(){function t(e){v(this,t),this.pattern=e}return e(t,[{key:"search",value:function(){}}],[{key:"isMultiMatch",value:function(e){return U(e,this.multiRegex)}},{key:"isSingleMatch",value:function(e){return U(e,this.singleRegex)}}]),t}();function U(e,t){e=e.match(t);return e?e[1]:null}var L=function(){s(n,_);var t=u(n);function n(e){return v(this,n),t.call(this,e)}return e(n,[{key:"search",value:function(e){e=e===this.pattern;return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"exact"}},{key:"multiRegex",get:function(){return/^="(.*)"$/}},{key:"singleRegex",get:function(){return/^=(.*)$/}}]),n}(),V=function(){s(n,_);var t=u(n);function n(e){return v(this,n),t.call(this,e)}return e(n,[{key:"search",value:function(e){var t=-1===e.indexOf(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:"type",get:function(){return"inverse-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"$/}},{key:"singleRegex",get:function(){return/^!(.*)$/}}]),n}(),O=function(){s(n,_);var t=u(n);function n(e){return v(this,n),t.call(this,e)}return e(n,[{key:"search",value:function(e){e=e.startsWith(this.pattern);return{isMatch:e,score:e?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function(){return"prefix-exact"}},{key:"multiRegex",get:function(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^\^(.*)$/}}]),n}(),Q=function(){s(n,_);var t=u(n);function n(e){return v(this,n),t.call(this,e)}return e(n,[{key:"search",value:function(e){var t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:"type",get:function(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function(){return/^!\^(.*)$/}}]),n}(),G=function(){s(n,_);var t=u(n);function n(e){return v(this,n),t.call(this,e)}return e(n,[{key:"search",value:function(e){var t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}],[{key:"type",get:function(){return"suffix-exact"}},{key:"multiRegex",get:function(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^(.*)\$$/}}]),n}(),X=function(){s(n,_);var t=u(n);function n(e){return v(this,n),t.call(this,e)}return e(n,[{key:"search",value:function(e){var t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}],[{key:"type",get:function(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function(){return/^!(.*)\$$/}}]),n}(),Y=function(){s(l,_);var h=u(l);function l(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=n.location,r=void 0===r?$.location:r,i=n.threshold,i=void 0===i?$.threshold:i,o=n.distance,o=void 0===o?$.distance:o,c=n.includeMatches,c=void 0===c?$.includeMatches:c,s=n.findAllMatches,s=void 0===s?$.findAllMatches:s,a=n.minMatchCharLength,a=void 0===a?$.minMatchCharLength:a,u=n.isCaseSensitive,u=void 0===u?$.isCaseSensitive:u,n=n.ignoreLocation,n=void 0===n?$.ignoreLocation:n;return v(this,l),(t=h.call(this,e))._bitapSearch=new J(e,{location:r,threshold:i,distance:o,includeMatches:c,findAllMatches:s,minMatchCharLength:a,isCaseSensitive:u,ignoreLocation:n}),t}return e(l,[{key:"search",value:function(e){return this._bitapSearch.searchIn(e)}}],[{key:"type",get:function(){return"fuzzy"}},{key:"multiRegex",get:function(){return/^"(.*)"$/}},{key:"singleRegex",get:function(){return/^(.*)$/}}]),l}(),Z=function(){s(n,_);var t=u(n);function n(e){return v(this,n),t.call(this,e)}return e(n,[{key:"search",value:function(e){for(var t,n=0,r=[],i=this.pattern.length;-1<(t=e.indexOf(this.pattern,n));)r.push([t,(n=t+i)-1]);var o=!!r.length;return{isMatch:o,score:o?0:1,indices:r}}}],[{key:"type",get:function(){return"include"}},{key:"multiRegex",get:function(){return/^'"(.*)"$/}},{key:"singleRegex",get:function(){return/^'(.*)$/}}]),n}(),A=[L,Z,O,Q,X,G,V,Y],ee=A.length,te=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,ne="|";var re=new Set([Y.type,Z.type]),L=function(){function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.isCaseSensitive,n=void 0===n?$.isCaseSensitive:n,r=t.includeMatches,r=void 0===r?$.includeMatches:r,i=t.minMatchCharLength,i=void 0===i?$.minMatchCharLength:i,o=t.ignoreLocation,o=void 0===o?$.ignoreLocation:o,c=t.findAllMatches,c=void 0===c?$.findAllMatches:c,s=t.location,s=void 0===s?$.location:s,a=t.threshold,a=void 0===a?$.threshold:a,t=t.distance,t=void 0===t?$.distance:t;v(this,u),this.query=null,this.options={isCaseSensitive:n,includeMatches:r,minMatchCharLength:i,findAllMatches:c,ignoreLocation:o,location:s,threshold:a,distance:t},this.pattern=n?e:e.toLowerCase(),this.query=function(e,t){var f=1<arguments.length&&void 0!==t?t:{};return e.split(ne).map(function(e){for(var t=e.trim().split(te).filter(function(e){return e&&!!e.trim()}),n=[],r=0,i=t.length;r<i;r+=1){for(var o=t[r],c=!1,s=-1;!c&&++s<ee;){var a=A[s],u=a.isMultiMatch(o);u&&(n.push(new a(u,f)),c=!0)}if(!c)for(s=-1;++s<ee;){var h=A[s],l=h.isSingleMatch(o);if(l){n.push(new h(l,f));break}}}return n})}(this.pattern,this.options)}return e(u,[{key:"searchIn",value:function(e){var t=this.query;if(t)for(var n=this.options,r=n.includeMatches,i=(e=n.isCaseSensitive?e:e.toLowerCase(),0),o=[],c=0,s=0,a=t.length;s<a;s+=1){for(var u,h=t[s],i=o.length=0,l=0,f=h.length;l<f;l+=1){var d=h[l],v=d.search(e),g=v.isMatch,y=v.indices,v=v.score;if(!g){o.length=i=c=0;break}i+=1,c+=v,r&&(g=d.constructor.type,re.has(g)?o=[].concat(p(o),p(y)):o.push(y))}if(i)return u={isMatch:!0,score:c/i},r&&(u.indices=o),u}return{isMatch:!1,score:1}}}],[{key:"condition",value:function(e,t){return t.useExtendedSearch}}]),u}(),j=[];function I(e,t){for(var n=0,r=j.length;n<r;n+=1){var i=j[n];if(i.condition(e,t))return new i(e,t)}return new J(e,t)}function ie(t){return c({},C.AND,Object.keys(t).map(function(e){return c({},e,t[e])}))}var C={AND:"$and",OR:"$or"},E={PATH:"$path",PATTERN:"$val"},R=function(e){return!(!e[C.AND]&&!e[C.OR])};function oe(e,c){var t=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).auto,s=void 0===t||t;return function t(n){var r,e=Object.keys(n),i=!!n[E.PATH];if(!i&&1<e.length&&!R(n))return t(ie(n));if(l(o=n)||!g(o)||R(o))return r={children:[],operator:e[0]},e.forEach(function(e){e=n[e];l(e)&&e.forEach(function(e){r.children.push(t(e))})}),r;var o=i?n[E.PATH]:e[0],e=i?n[E.PATTERN]:n[o];if(f(e))return i={keyId:w(o),pattern:e},s&&(i.searcher=I(e,c)),i;throw new Error("Invalid value for key ".concat(o))}(e=R(e)?e:ie(e))}function ce(e,n){e=e.matches;n.matches=[],y(e)&&e.forEach(function(e){var t;y(e.indices)&&e.indices.length&&(t={indices:e.indices,value:e.value},e.key&&(t.key=e.key.src),-1<e.idx&&(t.refIndex=e.idx),n.matches.push(t))})}function se(e,t){t.score=e.score}O=function(){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length?arguments[2]:void 0;v(this,r),this.options=i(i({},$),t),this.options.useExtendedSearch,this._keyStore=new K(this.options.keys),this.setCollection(e,n)}return e(r,[{key:"setCollection",value:function(e,t){if(this._docs=e,t&&!(t instanceof S))throw new Error("Incorrect 'index' type");this._myIndex=t||B(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}},{key:"add",value:function(e){y(e)&&(this._docs.push(e),this._myIndex.add(e))}},{key:"remove",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){return!1},t=[],n=0,r=this._docs.length;n<r;n+=1){var i=this._docs[n];e(i,n)&&(this.removeAt(n),--n,--r,t.push(i))}return t}},{key:"removeAt",value:function(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}},{key:"getIndex",value:function(){return this._myIndex}},{key:"search",value:function(e){var t,i,n=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).limit,n=void 0===n?-1:n,r=this.options,o=r.includeMatches,c=r.includeScore,s=r.shouldSort,a=r.sortFn,r=r.ignoreFieldNorm,e=f(e)?f(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return t=e,i=void 0===(r=(r={ignoreFieldNorm:r}).ignoreFieldNorm)?$.ignoreFieldNorm:r,t.forEach(function(e){var r=1;e.matches.forEach(function(e){var t=e.key,n=e.norm,e=e.score,t=t?t.weight:null;r*=Math.pow(0===e&&t?Number.EPSILON:e,(t||1)*(i?1:n))}),e.score=r}),s&&e.sort(a),function(e,r,t){var t=2<arguments.length&&void 0!==t?t:{},n=void 0===(n=t.includeMatches)?$.includeMatches:n,t=t.includeScore,t=void 0===t?$.includeScore:t,i=[];return n&&i.push(ce),t&&i.push(se),e.map(function(t){var e=t.idx,n={item:r[e],refIndex:e};return i.length&&i.forEach(function(e){e(t,n)}),n})}(e=d(n)&&-1<n?e.slice(0,n):e,this._docs,{includeMatches:o,includeScore:c})}},{key:"_searchStringList",value:function(e){var c=I(e,this.options),e=this._myIndex.records,s=[];return e.forEach(function(e){var t,n,r,i=e.v,o=e.i,e=e.n;y(i)&&(t=(r=c.searchIn(i)).isMatch,n=r.score,r=r.indices,t)&&s.push({item:i,idx:o,matches:[{score:n,value:i,norm:e,indices:r}]})}),s}},{key:"_searchLogical",value:function(e){function u(e,t,n){var r,i;if(!e.children)return i=e.keyId,r=e.searcher,(i=h._findMatches({key:h._keyStore.get(i),value:h._myIndex.getValueForItemAtKeyId(t,i),searcher:r}))&&i.length?[{idx:n,item:t,matches:i}]:[];for(var o=[],c=0,s=e.children.length;c<s;c+=1){var a=u(e.children[c],t,n);if(a.length)o.push.apply(o,p(a));else if(e.operator===C.AND)return[]}return o}var h=this,r=oe(e,this.options),e=this._myIndex.records,i={},o=[];return e.forEach(function(e){var t=e.$,n=e.i;y(t)&&(e=u(r,t,n)).length&&(i[n]||(i[n]={idx:n,item:t,matches:[]},o.push(i[n])),e.forEach(function(e){var t,e=e.matches;(t=i[n].matches).push.apply(t,p(e))}))}),o}},{key:"_searchObjectList",value:function(e){var i=this,o=I(e,this.options),e=this._myIndex,t=e.keys,e=e.records,c=[];return e.forEach(function(e){var n,r=e.$,e=e.i;y(r)&&(n=[],t.forEach(function(e,t){n.push.apply(n,p(i._findMatches({key:e,value:r[t],searcher:o})))}),n.length)&&c.push({idx:e,item:r,matches:n})}),c}},{key:"_findMatches",value:function(e){var c,t,n,r,s=e.key,i=e.value,a=e.searcher;return y(i)?(c=[],l(i)?i.forEach(function(e){var t,n,r,i=e.v,o=e.i,e=e.n;y(i)&&(t=(r=a.searchIn(i)).isMatch,n=r.score,r=r.indices,t)&&c.push({score:n,key:s,value:i,idx:o,norm:e,indices:r})}):(e=i.v,i=i.n,t=(r=a.searchIn(e)).isMatch,n=r.score,r=r.indices,t&&c.push({score:n,key:s,value:e,norm:i,indices:r})),c):[]}}]),r}();return O.version="6.6.2",O.createIndex=B,O.parseIndex=function(e){var t=void 0===(t=(n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).getFn)?$.getFn:t,n=void 0===(n=n.fieldNormWeight)?$.fieldNormWeight:n,r=e.keys,e=e.records;return(t=new S({getFn:t,fieldNormWeight:n})).setKeys(r),t.setIndexRecords(e),t},O.config=$,O.parseQuery=oe,function(){j.push.apply(j,arguments)}(L),O});